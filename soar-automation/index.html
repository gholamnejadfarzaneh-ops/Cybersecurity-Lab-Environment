<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOAR & Splunk Automation | Farzaneh G.</title>
    <style>
        :root { --accent: #EDAB9D; --text: #1a1a1a; --secondary: #666; }
        body { font-family: -apple-system, "Inter", sans-serif; line-height: 1.7; color: var(--text); max-width: 750px; margin: 0 auto; padding: 4rem 2rem; }
        nav { margin-bottom: 3rem; }
        nav a { text-decoration: none; color: var(--accent); font-size: 0.9rem; font-weight: 500; }
        h1 { font-size: 2rem; letter-spacing: -0.01em; margin-bottom: 0.5rem; }
        .subtitle { color: var(--secondary); margin-bottom: 3rem; font-style: italic; }
        h2 { font-size: 1.2rem; margin-top: 2.5rem; color: var(--text); border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .tech-tags { margin: 1rem 0; }
        .tag { font-size: 0.7rem; background: #f0f0f0; padding: 4px 10px; border-radius: 12px; margin-right: 5px; color: #555; font-weight: 600; }
        .code-block { background: #1e1e1e; color: #d4d4d4; padding: 1.5rem; border-radius: 4px; font-family: 'Courier New', monospace; font-size: 0.85rem; overflow-x: auto; margin: 2rem 0; border-left: 4px solid var(--accent); }
    </style>
</head>
<body>
    <nav><a href="/">← Return to Portfolio</a></nav>
    <header>
        <h1>SOAR: Splunk & Python Automation Pipeline</h1>
        <p class="subtitle">Automating Incident Response Workflows to Reduce MTTR</p>
        <div class="tech-tags">
            <span class="tag">PYTHON 3</span>
            <span class="tag">SPLUNK SDK</span>
            <span class="tag">REST API</span>
            <span class="tag">SOAR</span>
        </div>
    </header>

    <main>
        <p>In a modern SOC environment, alert fatigue is a primary risk. This project involves the development of a custom <strong>SOAR (Security Orchestration, Automation, and Response)</strong> script using Python to automate the enrichment and containment of security incidents triggered by Splunk Enterprise.</p>

        <h2>The Automation Workflow</h2>
        <p>The pipeline follows a structured logic to handle suspicious login attempts (Brute Force) detected via Splunk logs:</p>
        <ul>
            <li><strong>Detection:</strong> A Splunk Saved Search triggers a webhook when threshold-based login failures occur.</li>
            <li><strong>Enrichment:</strong> The Python script queries the <em>VirusTotal API</em> and <em>AbuseIPDB</em> to verify the reputation of the source IP address.</li>
            <li><strong>Containment:</strong> If the risk score exceeds a defined threshold, the script automatically updates <em>Cisco Umbrella</em> or <em>Palo Alto FW</em> blocklists via REST API.</li>
            <li><strong>Notification:</strong> A summary of the action is sent to the SOC team via Slack/Microsoft Teams for final review.</li>
        </ul>

        <div class="code-block">
            # Snippet: Splunk Search Result Processing<br>
            import splunklib.client as client<br>
            import requests<br><br>
            def check_ip_reputation(ip):<br>
            &nbsp;&nbsp;&nbsp;&nbsp;url = f"https://api.abuseipdb.com/api/v2/check?ipAddress={ip}"<br>
            &nbsp;&nbsp;&nbsp;&nbsp;headers = {'Key': API_KEY, 'Accept': 'application/json'}<br>
            &nbsp;&nbsp;&nbsp;&nbsp;response = requests.get(url, headers=headers)<br>
            &nbsp;&nbsp;&nbsp;&nbsp;return response.json()['data']['abuseConfidenceScore']
        </div>

        <h2>Strategic Value</h2>
        <p>By implementing this Python-based orchestration, the <strong>Mean Time to Respond (MTTR)</strong> for known commodity attacks was reduced by 85%. This allows Tier 2 and Tier 3 analysts to focus on high-fidelity, complex threat hunting rather than manual IP blacklisting.</p>
    </main>

    <footer>
        Farzaneh Gholamnejad · Security Automation Lab
    </footer>
</body>
</html>
